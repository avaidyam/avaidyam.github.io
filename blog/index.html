<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Aditya Vaidyam RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Aditya Vaidyam Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Aditya Vaidyam JSON Feed"><title data-rh="true">Aditya Vaidyam | Aditya Vaidyam</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aditya.vaidyam.me//logo.png"><meta data-rh="true" name="twitter:image" content="https://aditya.vaidyam.me//logo.png"><meta data-rh="true" property="og:url" content="https://aditya.vaidyam.me//blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Aditya Vaidyam | Aditya Vaidyam"><meta data-rh="true" name="description" content="Exploring macOS Internals"><meta data-rh="true" property="og:description" content="Exploring macOS Internals"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/photo.png"><link data-rh="true" rel="canonical" href="https://aditya.vaidyam.me//blog"><link data-rh="true" rel="alternate" href="https://aditya.vaidyam.me//blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://aditya.vaidyam.me//blog" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a02a6c90.css">
<link rel="preload" href="/assets/js/runtime~main.93e70d6f.js" as="script">
<link rel="preload" href="/assets/js/main.e3448e2d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">Aditya Vaidyam</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/">Contact</a><ul class="dropdown__menu"><li><a href="mailto:aditya@vaidyam.me" target="_blank" rel="noopener noreferrer" class="dropdown__link">Send an Email</a></li><li><a href="https://calendly.com/avaidyam/meet" target="_blank" rel="noopener noreferrer" class="dropdown__link">Schedule a Meeting</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/06/02/">On the debate of iOS vs. macOS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2019/02/19/">DIY: Core Animation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/03/22/">An Exercise in Modern Cocoa Views</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/03/16/">Building a Better RegisterEventHotKey</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/02/22/">The Secret Life of Core Animation</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/02/19/">CAStateController &amp; Friends</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/02/18/">CAPortalLayer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2018/02/17/">CAPluginLayer &amp; CABackdropLayer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2017/10/01/">ViewBridge.framework: It works!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2016/08/05/">Picture-in-Picture on macOS Sierra</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/2016/07/12/">NSExtension  &amp; PlugInKit</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2019/06/02/">On the debate of iOS vs. macOS</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2019-06-02T00:00:00.000Z" itemprop="datePublished">June 2, 2019</time> · <!-- -->8 min read</div></header><div class="markdown" itemprop="articleBody"><p>I&#x27;ve been seeing a lot of opinions on this topic and decided to articulate some of my own after having spent a month primarily using an iPad for nearly everything. I&#x27;ve closely monitored the few cases where I&#x27;ve needed to use my MacBook Pro and effectively made a list of things iOS should implement for feature parity with macOS.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about On the debate of iOS vs. macOS" href="/blog/2019/06/02/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2019/02/19/">DIY: Core Animation</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2019-02-19T00:00:00.000Z" itemprop="datePublished">February 19, 2019</time> · <!-- -->6 min read</div></header><div class="markdown" itemprop="articleBody"><p><a href="https://github.com/avaidyam/DIYAnimation" target="_blank" rel="noopener noreferrer">(Check out the project over here.)</a></p><p>After having been a consumer of the <strong>Core Animation</strong> (originally <strong>LayerKit</strong>) framework for about a decade now, I began to wonder how it was designed and implemented under the hood. Not simply the surface details such as &quot;it&#x27;s rendered out of process&quot; or &quot;it handles the animation interpolation for you&quot; or whatnot, but more specifically, <strong>HOW</strong> all of its beautiful bells and whistles translate into nitty gritty graphics ideas and associated draw calls. I figured the best way was to try to build it myself from scratch!</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about DIY: Core Animation" href="/blog/2019/02/19/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2018/03/22/">An Exercise in Modern Cocoa Views</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2018-03-22T00:00:00.000Z" itemprop="datePublished">March 22, 2018</time> · <!-- -->43 min read</div></header><div class="markdown" itemprop="articleBody"><p>Like I said in the previous &quot;episode&quot;, recently, I&#x27;ve wanted to get around to adding &quot;hot key&quot; support for Parrot, and realized I didn&#x27;t like any of the existing solutions:</p><ol><li>Use <code>MASShortcut</code> or <code>ShortcutRecorder</code> which are tried and proven to work in ObjC-land.</li><li>Use a new but not proven Swift hotkey recorder (there&#x27;s a few out there).</li><li>Roll my own (probably somehow using dangerous private SPI) and not test it at all! </li></ol><p><em>Obviously I went with option #3.</em> </p><p>And here we are now, onto part two of the thrilling saga in which you witness me breaking AppKit and WindowServer and inviting the wrath and fury of the engineers that work on said components. I hope you brought your popcorn.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about An Exercise in Modern Cocoa Views" href="/blog/2018/03/22/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2018/03/16/">Building a Better RegisterEventHotKey</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2018-03-16T00:00:00.000Z" itemprop="datePublished">March 16, 2018</time> · <!-- -->17 min read</div></header><div class="markdown" itemprop="articleBody"><p>Okay, well, maybe not better, but at least, not under imminent threat of deprecation - and even that is questionable, because we&#x27;ll be using <code>[Private SPI]</code> (I mean, would you really be here reading this if it didn&#x27;t? At least I&#x27;ve marked it all so you can cut it out for MAS apps.)</p><p>Recently, I&#x27;ve wanted to get around to adding &quot;hot key&quot; support for Parrot, and realized I didn&#x27;t like any of the existing solutions:</p><ol><li>Use <code>MASShortcut</code> or <code>ShortcutRecorder</code> which are tried and proven to work in ObjC-land.</li><li>Use a new but not proven Swift hotkey recorder (there&#x27;s a few out there).</li><li>Roll my own using dangerous private SPI and not test it at all! </li></ol><p><em>Obviously I went with option #3.</em></p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about Building a Better RegisterEventHotKey" href="/blog/2018/03/16/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2018/02/22/">The Secret Life of Core Animation</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2018-02-22T00:00:00.000Z" itemprop="datePublished">February 22, 2018</time> · <!-- -->6 min read</div></header><div class="markdown" itemprop="articleBody"><p>Most developers know of Core Animation through its few key classes, such as <code>CALayer</code> and <code>CAAnimation</code>, and their subclasses. Very few need to venture past this realm to take advantage of this powerful framework. What&#x27;s not very clear to most is how many faces the framework takes on; there are three: <code>CoreAnimation</code>, <code>CoreAnimationCF</code>, and the internal C++ CoreAnimation underpinnings.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about The Secret Life of Core Animation" href="/blog/2018/02/22/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2018/02/19/">CAStateController &amp; Friends</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2018-02-19T00:00:00.000Z" itemprop="datePublished">February 19, 2018</time> · <!-- -->4 min read</div></header><div class="markdown" itemprop="articleBody"><p><code>CALayer</code> has internal/private support for two pretty cool things: archives and states. We&#x27;ll talk about states first, as they&#x27;re the more complex part of the exercise.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about CAStateController &amp; Friends" href="/blog/2018/02/19/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2018/02/18/">CAPortalLayer</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2018-02-18T00:00:00.000Z" itemprop="datePublished">February 18, 2018</time> · <!-- -->2 min read</div></header><div class="markdown" itemprop="articleBody"><p>In the macOS 10.13.4 beta, I spotted a new <code>CALayer</code> class called <code>CAPortalLayer</code> being used in AppKit, and apparently also in UIKit. After looking into it a bit more, it turns out it does exactly what <code>CAPluginLayer</code> did for <code>CGSWindow</code>/<code>NSWindow</code> but for <code>CALayer</code>s!</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about CAPortalLayer" href="/blog/2018/02/18/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2018/02/17/">CAPluginLayer &amp; CABackdropLayer</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2018-02-17T00:00:00.000Z" itemprop="datePublished">February 17, 2018</time> · <!-- -->4 min read</div></header><div class="markdown" itemprop="articleBody"><p>There&#x27;s a lot of cool CoreAnimation goodies hiding around in the private headers, but there are three private <code>CALayer</code> classes that really caught my eye: <code>CAProxyLayer</code>, <code>CALayerHost</code>, <code>CABackdropLayer</code>, and <code>CAPluginLayer</code>. <code>CALayerHost</code> is similar in design to <code>CARemoteLayerClient/Server</code>, so I&#x27;ll be writing about both of these classes in a later post. I experimented with <code>CAProxyLayer</code> a little bit, as it&#x27;s used for visual effects (think <code>NS/UIVisualEffectView</code>) and either I didn&#x27;t know the right constants or wasn&#x27;t using it correctly, but I couldn&#x27;t get it to work reliably without nuking <code>windowserver</code>. I&#x27;ll talk about the remaining two, using code samples.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about CAPluginLayer &amp; CABackdropLayer" href="/blog/2018/02/17/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2017/10/01/">ViewBridge.framework: It works!</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2017-10-01T00:00:00.000Z" itemprop="datePublished">October 1, 2017</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>Around two years ago I began looking into ViewBridge.framework and a bunch of related frameworks as a side-project, mostly for fun. Realizing I had figured out most of it but just hadn’t put it together, I assembled a quick demo project that worked almost instantly with ViewBridge. All I had to do was create an XPC service, add a few Info.plist keys, grab the headers (I cleaned a few up) and I was on the road.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about ViewBridge.framework: It works!" href="/blog/2017/10/01/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2016/08/05/">Picture-in-Picture on macOS Sierra</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2016-08-05T00:00:00.000Z" itemprop="datePublished">August 5, 2016</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>Similar to iOS, macOS recently gained Picture-In-Picture mode for videos; so far, only Safari seems to support it out of the box. The question remains: why isn’t it a public API? That’s a question we’ll never have an answer for, but as it turns out, PIP.framework does exist in the PrivateFrameworks realm, and a quick job of reverse engineering shows exactly how it works.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about Picture-in-Picture on macOS Sierra" href="/blog/2016/08/05/"><b>Read More</b></a></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_Ikge" itemprop="headline"><a itemprop="url" href="/blog/2016/07/12/">NSExtension  &amp; PlugInKit</a></h2><div class="blogPostData_SAv4 margin-vert--md"><time datetime="2016-07-12T00:00:00.000Z" itemprop="datePublished">July 12, 2016</time> · <!-- -->10 min read</div></header><div class="markdown" itemprop="articleBody"><p>Recently I’ve been doing a lot of reverse engineering in the <code>PrivateFrameworks</code> department, simply out of curiosity. One thing that really always bothered me was how to insert a view hierarchy across processes — and I was interested in seeing how Apple had done it. A few frameworks of note: <code>ViewBridge.framework</code>, <code>PlugInKit.framework</code>, <code>LaunchServices.framework</code>, and finally, <code>libextension.dylib</code>. The last one is a bit weird because it’s actually a high level Objective-C framework that’s tied into <code>AppKit</code> — but for some reason has been relegated to <code>/usr/lib</code> (but is now located in <code>Foundation.framework</code> in macOS Sierra). All of the frameworks above use a common transmission medium: the <code>NSXPCConnection</code> API, which internally wraps the <code>libxpc.dylib</code> library, found in <code>/usr/lib/system</code>.</p></div><footer class="row docusaurus-mt-lg"><div class="col text--right"><a aria-label="Read more about NSExtension  &amp; PlugInKit" href="/blog/2016/07/12/"><b>Read More</b></a></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div></div>
<script src="/assets/js/runtime~main.93e70d6f.js"></script>
<script src="/assets/js/main.e3448e2d.js"></script>
</body>
</html>